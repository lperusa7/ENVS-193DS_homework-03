---
title: "ENVS-193DS_homework-03"
format: html
---

The link to my GitHub repository is [here](https://github.com/lperusa7/ENVS-193DS_homework-03)

## Setup

```{r}
warning = FALSE
message = FALSE

library(tidyverse)
library(here)
library(flextable)
library(readxl)
library(janitor)

# read in personal data
personal <- read_csv(
  # file path
  here("data", "ES193DS_Personal_Data.csv"))
```

# Problem 1: Personal Data

## a. 

For my personal data, I'm observing how many tasks I complete in a given study session, while listening to different genres of music during each study session to then be able to see if the music genre has an affect on my productivity rate. I then use the number of tasks completed to then calculate my productivity rate, to then compare the change in my productivity rate, which is (number of tasks / time), based on the different categories of music genres.

## b.


```{r, data-cleaning}
# creatig clean data frame
personal_cleaned <- personal |> # choosing personal data frame
  # cleaning column names
  clean_names() |>
  select(date, study_period, music_genre, work_environment, time_of_day, sleep, productivity)
```

```{r, making-plot}
ggplot(data = personal_cleaned, # choose data frame
       aes(x = music_genre, # assign x-axis
           y = productivity, # assign y-axis
           fill = music_genre)) + # assign boxes by music_genre
  geom_boxplot(color = "black") + # make box plot and s
  geom_jitter(width = 0.2, # making points jitter horizontally
              alpha = 0.5) + # making points slightly transparent
  geom_point() +
         labs(x = "Music Genre", # changing label for x-axis
              y = "Productivity (Tasks completed per hour)", # changing label for y-axis
              title = "Average Task Completion Rate Based on Music Genre") + # adding title name
  theme_minimal() + # adding minimal theme
  theme(legend.position = "none") # getting rid of legend
```

## c.

**Figure 1. Productivity Rate is higher when listening to Classical and Lofi music**
Data from 'ES193DS_Personal_Data.csv' (Lescano, L. 2025).
Points represent individual study period productivity rate (total n = 16), jittered horizontally to reduce overlap. Bold horizontal line represents the mean productivity rate for the group.

## d.

```{r, summarizing-data}
# Step 1: Summarise the data by music genre

summary_table <- personal_cleaned |> # creating summarized data object
  group_by(music_genre) |> # group rows by music genre
  summarise(mean_productivity = round(mean(productivity, # calculates mean within each group
                                           na.rm = TRUE), 1))
# Step 2: Create and format flextable

flextable(summary_table) |> # create a table from the summary data
  set_header_labels( # rename column headers for clarity
    music_genre = "Music Genre",
    mean_productivity = "Mean Productivity (Tasks Completed per Hour)"
  ) |> 
    align(j = "mean_productivity", align = "center", part = "all") |> #center values in productivity column
  autofit() |> # auto-adjust column widths to fit content
  add_header_lines("Average Productivity Rate by Music Genre") # add a custom title above the table
```

